\hypertarget{classcaffe_1_1MultinomialLogisticLossLayer}{}\section{caffe\+:\+:Multinomial\+Logistic\+Loss\+Layer$<$ Dtype $>$ Class Template Reference}
\label{classcaffe_1_1MultinomialLogisticLossLayer}\index{caffe\+::\+Multinomial\+Logistic\+Loss\+Layer$<$ Dtype $>$@{caffe\+::\+Multinomial\+Logistic\+Loss\+Layer$<$ Dtype $>$}}


Computes the multinomial logistic loss for a one-\/of-\/many classification task, directly taking a predicted probability distribution as input.  




{\ttfamily \#include $<$multinomial\+\_\+logistic\+\_\+loss\+\_\+layer.\+hpp$>$}

Inheritance diagram for caffe\+:\+:Multinomial\+Logistic\+Loss\+Layer$<$ Dtype $>$\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3.000000cm]{classcaffe_1_1MultinomialLogisticLossLayer}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
{\bfseries Multinomial\+Logistic\+Loss\+Layer} (const Layer\+Parameter \&param)\hypertarget{classcaffe_1_1MultinomialLogisticLossLayer_a1c9567f9901885ec4737cf9315d52081}{}\label{classcaffe_1_1MultinomialLogisticLossLayer_a1c9567f9901885ec4737cf9315d52081}

\item 
virtual void \hyperlink{classcaffe_1_1MultinomialLogisticLossLayer_a906947b9029c3ba8127591c49855ccb6}{Reshape} (const vector$<$ \hyperlink{classcaffe_1_1Blob}{Blob}$<$ Dtype $>$ $\ast$ $>$ \&bottom, const vector$<$ \hyperlink{classcaffe_1_1Blob}{Blob}$<$ Dtype $>$ $\ast$ $>$ \&top)
\begin{DoxyCompactList}\small\item\em Adjust the shapes of top blobs and internal buffers to accommodate the shapes of the bottom blobs. \end{DoxyCompactList}\item 
virtual const char $\ast$ \hyperlink{classcaffe_1_1MultinomialLogisticLossLayer_abae46c53aa81a1517d85d6704f2f71a6}{type} () const \hypertarget{classcaffe_1_1MultinomialLogisticLossLayer_abae46c53aa81a1517d85d6704f2f71a6}{}\label{classcaffe_1_1MultinomialLogisticLossLayer_abae46c53aa81a1517d85d6704f2f71a6}

\begin{DoxyCompactList}\small\item\em Returns the layer type. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual void \hyperlink{classcaffe_1_1MultinomialLogisticLossLayer_ac1b7b60b9439d9679664783a167a36d6}{Forward\+\_\+cpu} (const vector$<$ \hyperlink{classcaffe_1_1Blob}{Blob}$<$ Dtype $>$ $\ast$ $>$ \&bottom, const vector$<$ \hyperlink{classcaffe_1_1Blob}{Blob}$<$ Dtype $>$ $\ast$ $>$ \&top)
\begin{DoxyCompactList}\small\item\em Computes the multinomial logistic loss for a one-\/of-\/many classification task, directly taking a predicted probability distribution as input. \end{DoxyCompactList}\item 
virtual void \hyperlink{classcaffe_1_1MultinomialLogisticLossLayer_a93b273f7c2180dff92cbc8d4f5ba353d}{Backward\+\_\+cpu} (const vector$<$ \hyperlink{classcaffe_1_1Blob}{Blob}$<$ Dtype $>$ $\ast$ $>$ \&top, const vector$<$ bool $>$ \&propagate\+\_\+down, const vector$<$ \hyperlink{classcaffe_1_1Blob}{Blob}$<$ Dtype $>$ $\ast$ $>$ \&bottom)
\begin{DoxyCompactList}\small\item\em Computes the multinomial logistic loss error gradient w.\+r.\+t. the predictions. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}
\subsubsection*{template$<$typename Dtype$>$\\*
class caffe\+::\+Multinomial\+Logistic\+Loss\+Layer$<$ Dtype $>$}

Computes the multinomial logistic loss for a one-\/of-\/many classification task, directly taking a predicted probability distribution as input. 

When predictions are not already a probability distribution, you should instead use the \hyperlink{classcaffe_1_1SoftmaxWithLossLayer}{Softmax\+With\+Loss\+Layer}, which maps predictions to a distribution using the \hyperlink{classcaffe_1_1SoftmaxLayer}{Softmax\+Layer}, before computing the multinomial logistic loss. The \hyperlink{classcaffe_1_1SoftmaxWithLossLayer}{Softmax\+With\+Loss\+Layer} should be preferred over separate \hyperlink{classcaffe_1_1SoftmaxLayer}{Softmax\+Layer} + \hyperlink{classcaffe_1_1MultinomialLogisticLossLayer}{Multinomial\+Logistic\+Loss\+Layer} as its gradient computation is more numerically stable.


\begin{DoxyParams}{Parameters}
{\em bottom} & input \hyperlink{classcaffe_1_1Blob}{Blob} vector (length 2)
\begin{DoxyEnumerate}
\item $ (N \times C \times H \times W) $ the predictions $ \hat{p} $, a \hyperlink{classcaffe_1_1Blob}{Blob} with values in $ [0, 1] $ indicating the predicted probability of each of the $ K = CHW $ classes. Each prediction vector $ \hat{p}_n $ should sum to 1 as in a probability distribution\+: $ \forall n \sum\limits_{k=1}^K \hat{p}_{nk} = 1 $.
\item $ (N \times 1 \times 1 \times 1) $ the labels $ l $, an integer-\/valued \hyperlink{classcaffe_1_1Blob}{Blob} with values $ l_n \in [0, 1, 2, ..., K - 1] $ indicating the correct class label among the $ K $ classes 
\end{DoxyEnumerate}\\
\hline
{\em top} & output \hyperlink{classcaffe_1_1Blob}{Blob} vector (length 1)
\begin{DoxyEnumerate}
\item $ (1 \times 1 \times 1 \times 1) $ the computed multinomial logistic loss\+: $ E = \frac{-1}{N} \sum\limits_{n=1}^N \log(\hat{p}_{n,l_n}) $ 
\end{DoxyEnumerate}\\
\hline
\end{DoxyParams}


\subsection{Member Function Documentation}
\index{caffe\+::\+Multinomial\+Logistic\+Loss\+Layer@{caffe\+::\+Multinomial\+Logistic\+Loss\+Layer}!Backward\+\_\+cpu@{Backward\+\_\+cpu}}
\index{Backward\+\_\+cpu@{Backward\+\_\+cpu}!caffe\+::\+Multinomial\+Logistic\+Loss\+Layer@{caffe\+::\+Multinomial\+Logistic\+Loss\+Layer}}
\subsubsection[{\texorpdfstring{Backward\+\_\+cpu(const vector$<$ Blob$<$ Dtype $>$ $\ast$ $>$ \&top, const vector$<$ bool $>$ \&propagate\+\_\+down, const vector$<$ Blob$<$ Dtype $>$ $\ast$ $>$ \&bottom)}{Backward_cpu(const vector< Blob< Dtype > * > &top, const vector< bool > &propagate_down, const vector< Blob< Dtype > * > &bottom)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename Dtype $>$ void {\bf caffe\+::\+Multinomial\+Logistic\+Loss\+Layer}$<$ Dtype $>$\+::Backward\+\_\+cpu (
\begin{DoxyParamCaption}
\item[{const vector$<$ {\bf Blob}$<$ Dtype $>$ $\ast$ $>$ \&}]{top, }
\item[{const vector$<$ bool $>$ \&}]{propagate\+\_\+down, }
\item[{const vector$<$ {\bf Blob}$<$ Dtype $>$ $\ast$ $>$ \&}]{bottom}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}\hypertarget{classcaffe_1_1MultinomialLogisticLossLayer_a93b273f7c2180dff92cbc8d4f5ba353d}{}\label{classcaffe_1_1MultinomialLogisticLossLayer_a93b273f7c2180dff92cbc8d4f5ba353d}


Computes the multinomial logistic loss error gradient w.\+r.\+t. the predictions. 

Gradients cannot be computed with respect to the label inputs (bottom\mbox{[}1\mbox{]}), so this method ignores bottom\mbox{[}1\mbox{]} and requires !propagate\+\_\+down\mbox{[}1\mbox{]}, crashing if propagate\+\_\+down\mbox{[}1\mbox{]} is set.


\begin{DoxyParams}{Parameters}
{\em top} & output \hyperlink{classcaffe_1_1Blob}{Blob} vector (length 1), providing the error gradient with respect to the outputs
\begin{DoxyEnumerate}
\item $ (1 \times 1 \times 1 \times 1) $ This \hyperlink{classcaffe_1_1Blob}{Blob}\textquotesingle{}s diff will simply contain the loss\+\_\+weight$\ast$ $ \lambda $, as $ \lambda $ is the coefficient of this layer\textquotesingle{}s output $\ell_i$ in the overall \hyperlink{classcaffe_1_1Net}{Net} loss $ E = \lambda_i \ell_i + \mbox{other loss terms}$; hence $ \frac{\partial E}{\partial \ell_i} = \lambda_i $. ($\ast$\+Assuming that this top \hyperlink{classcaffe_1_1Blob}{Blob} is not used as a bottom (input) by any other layer of the \hyperlink{classcaffe_1_1Net}{Net}.) 
\end{DoxyEnumerate}\\
\hline
{\em propagate\+\_\+down} & see \hyperlink{classcaffe_1_1Layer_a53df1e081767e07bfb4c81657f4acd0a}{Layer\+::\+Backward}. propagate\+\_\+down\mbox{[}1\mbox{]} must be false as we can\textquotesingle{}t compute gradients with respect to the labels. \\
\hline
{\em bottom} & input \hyperlink{classcaffe_1_1Blob}{Blob} vector (length 2)
\begin{DoxyEnumerate}
\item $ (N \times C \times H \times W) $ the predictions $ \hat{p} $; Backward computes diff $ \frac{\partial E}{\partial \hat{p}} $
\item $ (N \times 1 \times 1 \times 1) $ the labels -- ignored as we can\textquotesingle{}t compute their error gradients 
\end{DoxyEnumerate}\\
\hline
\end{DoxyParams}


Implements \hyperlink{classcaffe_1_1Layer_a64d15855f882af4b82e83fa993c4e7c6}{caffe\+::\+Layer$<$ Dtype $>$}.

\index{caffe\+::\+Multinomial\+Logistic\+Loss\+Layer@{caffe\+::\+Multinomial\+Logistic\+Loss\+Layer}!Forward\+\_\+cpu@{Forward\+\_\+cpu}}
\index{Forward\+\_\+cpu@{Forward\+\_\+cpu}!caffe\+::\+Multinomial\+Logistic\+Loss\+Layer@{caffe\+::\+Multinomial\+Logistic\+Loss\+Layer}}
\subsubsection[{\texorpdfstring{Forward\+\_\+cpu(const vector$<$ Blob$<$ Dtype $>$ $\ast$ $>$ \&bottom, const vector$<$ Blob$<$ Dtype $>$ $\ast$ $>$ \&top)}{Forward_cpu(const vector< Blob< Dtype > * > &bottom, const vector< Blob< Dtype > * > &top)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename Dtype $>$ void {\bf caffe\+::\+Multinomial\+Logistic\+Loss\+Layer}$<$ Dtype $>$\+::Forward\+\_\+cpu (
\begin{DoxyParamCaption}
\item[{const vector$<$ {\bf Blob}$<$ Dtype $>$ $\ast$ $>$ \&}]{bottom, }
\item[{const vector$<$ {\bf Blob}$<$ Dtype $>$ $\ast$ $>$ \&}]{top}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}\hypertarget{classcaffe_1_1MultinomialLogisticLossLayer_ac1b7b60b9439d9679664783a167a36d6}{}\label{classcaffe_1_1MultinomialLogisticLossLayer_ac1b7b60b9439d9679664783a167a36d6}


Computes the multinomial logistic loss for a one-\/of-\/many classification task, directly taking a predicted probability distribution as input. 

When predictions are not already a probability distribution, you should instead use the \hyperlink{classcaffe_1_1SoftmaxWithLossLayer}{Softmax\+With\+Loss\+Layer}, which maps predictions to a distribution using the \hyperlink{classcaffe_1_1SoftmaxLayer}{Softmax\+Layer}, before computing the multinomial logistic loss. The \hyperlink{classcaffe_1_1SoftmaxWithLossLayer}{Softmax\+With\+Loss\+Layer} should be preferred over separate \hyperlink{classcaffe_1_1SoftmaxLayer}{Softmax\+Layer} + \hyperlink{classcaffe_1_1MultinomialLogisticLossLayer}{Multinomial\+Logistic\+Loss\+Layer} as its gradient computation is more numerically stable.


\begin{DoxyParams}{Parameters}
{\em bottom} & input \hyperlink{classcaffe_1_1Blob}{Blob} vector (length 2)
\begin{DoxyEnumerate}
\item $ (N \times C \times H \times W) $ the predictions $ \hat{p} $, a \hyperlink{classcaffe_1_1Blob}{Blob} with values in $ [0, 1] $ indicating the predicted probability of each of the $ K = CHW $ classes. Each prediction vector $ \hat{p}_n $ should sum to 1 as in a probability distribution\+: $ \forall n \sum\limits_{k=1}^K \hat{p}_{nk} = 1 $.
\item $ (N \times 1 \times 1 \times 1) $ the labels $ l $, an integer-\/valued \hyperlink{classcaffe_1_1Blob}{Blob} with values $ l_n \in [0, 1, 2, ..., K - 1] $ indicating the correct class label among the $ K $ classes 
\end{DoxyEnumerate}\\
\hline
{\em top} & output \hyperlink{classcaffe_1_1Blob}{Blob} vector (length 1)
\begin{DoxyEnumerate}
\item $ (1 \times 1 \times 1 \times 1) $ the computed multinomial logistic loss\+: $ E = \frac{-1}{N} \sum\limits_{n=1}^N \log(\hat{p}_{n,l_n}) $ 
\end{DoxyEnumerate}\\
\hline
\end{DoxyParams}


Implements \hyperlink{classcaffe_1_1Layer_add965883f75bbf90c7a06f960cda7a1a}{caffe\+::\+Layer$<$ Dtype $>$}.

\index{caffe\+::\+Multinomial\+Logistic\+Loss\+Layer@{caffe\+::\+Multinomial\+Logistic\+Loss\+Layer}!Reshape@{Reshape}}
\index{Reshape@{Reshape}!caffe\+::\+Multinomial\+Logistic\+Loss\+Layer@{caffe\+::\+Multinomial\+Logistic\+Loss\+Layer}}
\subsubsection[{\texorpdfstring{Reshape(const vector$<$ Blob$<$ Dtype $>$ $\ast$ $>$ \&bottom, const vector$<$ Blob$<$ Dtype $>$ $\ast$ $>$ \&top)}{Reshape(const vector< Blob< Dtype > * > &bottom, const vector< Blob< Dtype > * > &top)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename Dtype $>$ void {\bf caffe\+::\+Multinomial\+Logistic\+Loss\+Layer}$<$ Dtype $>$\+::Reshape (
\begin{DoxyParamCaption}
\item[{const vector$<$ {\bf Blob}$<$ Dtype $>$ $\ast$ $>$ \&}]{bottom, }
\item[{const vector$<$ {\bf Blob}$<$ Dtype $>$ $\ast$ $>$ \&}]{top}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{classcaffe_1_1MultinomialLogisticLossLayer_a906947b9029c3ba8127591c49855ccb6}{}\label{classcaffe_1_1MultinomialLogisticLossLayer_a906947b9029c3ba8127591c49855ccb6}


Adjust the shapes of top blobs and internal buffers to accommodate the shapes of the bottom blobs. 


\begin{DoxyParams}{Parameters}
{\em bottom} & the input blobs, with the requested input shapes \\
\hline
{\em top} & the top blobs, which should be reshaped as needed\\
\hline
\end{DoxyParams}
This method should reshape top blobs as needed according to the shapes of the bottom (input) blobs, as well as reshaping any internal buffers and making any other necessary adjustments so that the layer can accommodate the bottom blobs. 

Reimplemented from \hyperlink{classcaffe_1_1LossLayer_ab15b7120ebc172274481f3732db78c9e}{caffe\+::\+Loss\+Layer$<$ Dtype $>$}.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
include/caffe/layers/multinomial\+\_\+logistic\+\_\+loss\+\_\+layer.\+hpp\item 
src/caffe/layers/multinomial\+\_\+logistic\+\_\+loss\+\_\+layer.\+cpp\end{DoxyCompactItemize}
